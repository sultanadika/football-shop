{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {% block meta %}{% endblock meta %}
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
    <link rel="stylesheet" href="{% static 'css/global.css' %}" />
  </head>
  <body>
    {% if not request.path == '/login/' and not request.path == '/register/' %}
      {% include 'navbar.html' %}
    {% endif %}

    {% block content %}{% endblock content %}
    {% include 'toast.html' %}
    {% include 'modal.html' %}

    <!-- Mobile Menu Toggle & Toast Script -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // üåê Mobile Navbar Toggle
        const btn = document.getElementById("mobile-menu-button");
        const menu = document.getElementById("mobile-menu");

        if (btn && menu) {
          btn.addEventListener("click", function () {
            menu.classList.toggle("hidden");
          });
        }

        // üî• Global Toast Function
        window.showToast = function (title, message, type = "success") {
          const colors = {
            success: "bg-green-600",
            error: "bg-red-600",
            warning: "bg-yellow-500",
            info: "bg-blue-600"
          };

          const toast = document.createElement("div");
          toast.className = `
            fixed bottom-6 right-6 px-5 py-4 rounded-lg shadow-lg text-white 
            animate-fade-in-down z-50 ${colors[type] || "bg-green-600"}
          `;
          toast.innerHTML = `
            <strong class="block text-sm font-semibold">${title}</strong>
            <p class="text-sm">${message}</p>
          `;
          document.body.appendChild(toast);
          setTimeout(() => toast.remove(), 3000);
        };

        // ‚úÖ Show Logout Toast if Cookie Flag Exists
        const cookie = document.cookie.split("; ").find(row => row.startsWith("showLogoutToast="));
        if (cookie && cookie.split("=")[1] === "true") {
          showToast("‚úÖ Logged Out", "You‚Äôve successfully logged out.", "info");
          // Clear cookie immediately after showing toast
          document.cookie = "showLogoutToast=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
        }
      });
    </script>

    <!-- üí´ Optional Animation -->
    <style>
      @keyframes fadeInDown {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in-down {
        animation: fadeInDown 0.4s ease-in-out;
      }
    </style>
  </body>
</html>



